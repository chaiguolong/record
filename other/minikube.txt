1.cento8 å®‰è£…minikubeæ•™ç¨‹.
	0.å‰æ:
     +-----------------------------------------------------------+
     |  2ä¸ªæˆ–æ›´å¤šCPU                                             |
     |  2GBçš„å¯ç”¨å†…å­˜(å› ä¸ºæœ‰èƒŒçš„ç¨‹åºçš„åŸå› ,æˆ‘ç›´æ¥è®¾ç½®æˆ4G)       |
     |  20GBçš„å¯ç”¨ç£ç›˜ç©ºé—´(å› ä¸ºæœ‰åˆ«çš„ç¨‹åºçš„åŸå› ,æˆ‘è®¾ç½®æˆ25G)     |
     |  ç½‘ç»œè¿æ¥                                                 |
     |  å®¹å™¨æˆ–è™šæ‹Ÿæœºç®¡ç†å™¨ï¼Œä¾‹å¦‚ï¼šDocker(å°±æ˜¯ç³»ç»Ÿè¦å®‰è£…Docker)   |
     +-----------------------------------------------------------+

	1.ä»¥érootç”¨æˆ·,ä½†æ‹¥æœ‰rootæƒé™çš„ç”¨æˆ·å®‰è£…docker.
      +----------------------------+
      | sudo yum -y install docker |
      +----------------------------+

	2.dockeræœåŠ¡è®¾ç½®å¼€æœºå¯åŠ¨å’Œå¼€å¯dockeræœåŠ¡
      +------------------------------+
      | sudo systemctl enable docker |
      | sudo systemctl start docker  |
      +------------------------------+

	3.å®‰è£…Minikube
      +------------------------------------------------------------------------------------------------+
      | curl -Lo minikube https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64 |
      | && chmod +x minikube                                                                           |
      +------------------------------------------------------------------------------------------------+

	4.å°†Minikubeå¯æ‰§è¡Œæ–‡ä»¶æ·»åŠ åˆ°ç¯å¢ƒç›®å½•PATH.
      +---------------------------------------+
      | sudo mkdir -p /usr/local/bin/         |
      | sudo install minikube /usr/local/bin/ |
      +---------------------------------------+

	5.ä½¿ç”¨dockeré©±åŠ¨ç¨‹åºå¯åŠ¨é›†ç¾¤ï¼š
		minikube start --driver=docker

		å¦‚ä½•å¤±è´¥å®‰è£…æç¤ºè¿›è¡Œæ“ä½œ,å¯ä»¥çœ‹å®ƒæç¤ºçš„æ“ä½œæ–‡æ¡£.
		ä¸€èˆ¬æ“ä½œå¦‚ä¸‹:
		1).åˆ›å»ºdockerç»„
		sudo groupadd docker

		2).å°†æ‚¨çš„ç”¨æˆ·æ·»åŠ åˆ°è¯¥dockerç»„
		sudo usermod -aG docker $USER

		3).åœ¨Linuxä¸Šï¼Œæ‚¨è¿˜å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ¿€æ´»å¯¹ç»„çš„æ›´æ”¹
		newgrp docker

		4).é‡æ–°ä½¿ç”¨dockeré©±åŠ¨å¯åŠ¨é›†ç¾¤.
		minikube start --driver=docker

2.å°æŠ€å·§:
	1).kubectl get podså‘½ä»¤åå‘ç°statusä¸ºPending(æŒ‚èµ·)çŠ¶æ€,æ²¡æœ‰è¿è¡Œçš„åŸå› æ˜¯:è¯¥podè¢«åˆ†é…åˆ°çš„å·¥ä½œèŠ‚ç‚¹æ­£åœ¨ä¸‹è½½å®¹å™¨é•œåƒ,å®Œæˆåæ‰å¯ä»¥è¿è¡Œ.å¦‚æœpodä¸€ç›´åœç•™åœ¨æŒ‚èµ·çŠ¶æ€,é‚£ä¹ˆå¯èƒ½æ˜¯kubernetesæ— æ³•ä»é•œåƒä¸­å¿ƒæ‹‰å»é•œåƒ,å¦‚æœä½ æ­£åœ¨ä½¿ç”¨è‡ªå·±çš„é•œåƒ,ç¡®ä¿å®ƒåœ¨Docker Hubä¸Šæ˜¯å…¬å¼€çš„.

	2).replicationcontrollerçš„ç¼©å†™rc,podsç¼©å†™po,serviceç¼©å†™svc,namespaceç¼©å†™ä¸ºns,replicasetç¼©å†™ä¸ºrs

	3).rcå’Œdeploymentçš„å¤§è‡´åŠŸèƒ½:
      +------------------+
      | 1>.ç¡®ä¿podçš„æ•°é‡ |
      | 2>.ç¡®ä¿podçš„å¥åº· |
      | 3>.å¼¹æ€§ä¼¸ç¼©      |
      | 4>.æ»šåŠ¨å‡çº§      |
      +------------------+
	4).replicationcontrollerå·²ç»è¿‡æ—¶äº†,åœ¨æ–°ç‰ˆæœ¬ä¸­ç”¨deploymentä»£æ›¿.

	5).å‘½åç©ºé—´è¯´ç™½äº†(namespace)å°±æ˜¯æä¾›ä¸€ä¸ªä½œç”¨åŸŸ.

	6).ReplicationControllerç®¡ç†ä¸æ ‡ç­¾é€‰æ‹©å™¨åŒ¹é…é¢çš„pod.

3.minikubeå’Œdockerçš„å¸¸ç”¨å‘½ä»¤:
	1).docker run <image>:<tag>

	2).kubectl get pods				#è·å–é›†ç¾¤ç¦»å¾—pods(è¿™é‡Œçš„podså¯ä»¥æ”¹ä¸ºrc,)

	3).kubectl get po kubia-zxzij -o yaml		#-o yamlé€‰é¡¹æ¥è·å–podçš„æ•´ä¸ªYAMLå®šä¹‰.

	4).kubectl create -f kubia-manual.yaml		#ä½¿ç”¨kubectl createå‘½ä»¤ä»YAMLæ–‡ä»¶åˆ›å»ºpod.
    +------------------------------------------------------------------------------------------+
    |   apiVersion: v1                          <--------æè¿°æ–‡ä»¶éµå¾ªv1ç‰ˆæœ¬çš„kubernetes API    |
    |   kind: Pod                               <--------æˆ‘ä»¬åœ¨æè¿°ä¸€ä¸ªPod(æ³¨æ„å¤§å†™çš„P)        |
    |   metadata:                                                                              |
    |     name: kubia-manual                    <--------podçš„åç§°                             |
    |   spec:                                                                                  |
    |     containers:                                                                          |
    |     - image: chaiguolong1/kubia           <--------åˆ›å»ºå®¹å™¨æ‰€ç”¨çš„é•œåƒ                    |
    |       name: kubia                         <--------å®¹å™¨çš„åç§°                            |
    |       ports:                                                                             |
    |       - containerPort: 8080               <--------åº”ç”¨ç›‘å¬ç«¯å£                          |
    |         protocol: TCP                                                                    |
    +------------------------------------------------------------------------------------------+

	5).kubectl port-forward kubia-manual 8888->8080		<-------å°†æœºå™¨æœ¬åœ°ç«¯å£8888è½¬å‘åˆ°kubia-manual podçš„ç«¯å£8080.

	6).kubectl get po --show-labels			            <--------ç”¨--show-labelsé€‰é¡¹æŸ¥çœ‹æ ‡ç­¾

	7).kubectl get po -L creation_method,env			<-------ç”¨-Lé€‰é¡¹æŒ‡å®šè‡ªå·±æ„Ÿå…´è¶£çš„æ ‡ç­¾(creation-method,envä¸ºæ ‡ç­¾)

	8).kubectl get po -l creation_method=manual			<-------ä½¿ç”¨æ ‡ç­¾é€‰æ‹©å™¨åˆ—å‡ºpod(ç”¨-lé€‰é¡¹)

	9).kubectl get ns						            <--------åˆ—å‡ºé›†ç¾¤ä¸­æ‰€æœ‰çš„å‘½åç©ºé—´(ns=namespace)

	10).kubectl get po --namespace kube-system			<-------åˆ—å‡ºå±äºkube-systemå‘½åç©ºé—´çš„pod.(--namespaceå¯ä»¥ç”¨-næ¥ä»£æ›¿)

	11).kubectl create -f custom-namespace.yaml			<-------ä½¿ç”¨YAMLæ–‡ä»¶åˆ›å»ºå‘½åç©ºé—´.
    +-------------------------------+                      
    |   apiversion: v1              |
    |   kind: namespace             |
    |   metadata:                   |
    |     name: custom-namespace    |
    +-------------------------------+               

	12).kubectl create namespace custom-namespace		<-------ä½¿ç”¨å‘½ä»¤åˆ›å»ºå‘½åç©ºé—´

	13).å¦‚æœæƒ³è¦åœ¨åˆšåˆ›å»ºçš„å‘½åç©ºé—´ä¸­åˆ›å»ºèµ„æº,å¯ä»¥é€‰æ‹©åœ¨metadataå­—æ®µä¸­æ·»åŠ ä¸€ä¸ªnamespace: custom-namespanceeå±æ€§,ä¹Ÿå¯ä»¥åœ¨ä½¿ç”¨kubectl createå‘½ä»¤åˆ›å»ºèµ„æºæ—¶æŒ‡å®šå‘½åç©ºé—´.

	kubectl create -f kubia-manual.yaml -n custom-namespace

	14).kubectl delete po kubia-gpu			            <--------æŒ‰åç§°åˆ é™¤pod

	15).kubectl delete po -l creation_method=manual		<-------ä½¿ç”¨æ ‡ç­¾é€‰æ‹©å™¨åˆ é™¤pod.

	16).kubectl delete all --all				        <--------åˆ é™¤å‘½åç©ºé—´ä¸­çš„æ‰€æœ‰èµ„æº(ç¬¬ä¸€ä¸ªallæŒ‡å®šæ­£åœ¨åˆ é™¤èµ„æºçš„ç±»å‹,è€Œ--allé€‰é¡¹æŒ‡å®šå°†åˆ é™¤æ‰€æœ‰èµ„æºå®ä¾‹)

	17).kubectl label pod kubia-dmdck app=foo --overwrite		

		æ›´æ”¹å·²æ‰˜ç®¡çš„podçš„æ ‡ç­¾,--overwriteå‚æ•°æ˜¯å¿…è¦çš„,å¦åˆ™kubectlå°†åªæ‰“å°å‡ºè­¦å‘Š,å¹¶ä¸ä¼šæ›´æ”¹æ ‡ç­¾.è¿™æ ·æ˜¯ä¸ºäº†é˜²æ­¢ä½ æƒ³è¦æ·»åŠ æ–°æ ‡ç­¾æ—¶æ— æ„ä¸­æ›´æ”¹ç°æœ‰æ ‡ç­¾çš„å€¼.(app=fooæ˜¯æ ‡ç­¾,kubia-dmdckæ˜¯pod)

	18).kubectl edit rc kubia							<-----ä¿®æ”¹podæ¨¡æ¿

	19).kubectl scale rc kubia --replicas=10			<-------æ°´å¹³ç¼©æ”¾pod

		kubectl edit rc kubiaä¿®æ”¹spec.replicaså€¼ä¸º10é¡µå¯ä»¥åšåˆ°æ°´å¹³ç¼©æ”¾.

	20).å½“ä½¿ç”¨kubectl deleteåˆ é™¤ReplicationControlleræ—¶,å¯ä»¥é€šè¿‡ç»™å‘½ä»¤å¢åŠ --cascade=falseé€‰é¡¹ä¿æŒpodçš„è¿è¡Œ.

	21).kubectl api-versionsæŸ¥çœ‹apiç‰ˆæœ¬.

	22).å¦‚ä½•æŸ¥çœ‹podçš„æ—¥å¿—.

    +------------------------------------------------------+
    |                                                      |
    |   Wed Dec  2 14:56:39 UTC 2020 Batch job starting    |
    +------------------------------------------------------+

	23).å®šä¹‰Jobèµ„æº,ä¸‹é¢çš„é•œåƒä¼šè°ƒç”¨ä¸€ä¸ªè¿è¡Œ120sçš„è¿›ç¨‹,ç„¶åé€€å‡º,
    ä¸ºäº†åœ¨podåœ¨120såæ­£å¸¸é€€å‡º,å¯ä»¥é…ç½®podçš„å±æ€§:restartPolicyå®Œæˆ,
    é»˜è®¤ä¸ºAlways.éœ€è¦æ›´æ”¹ä¸ºOnFailureæˆ–Never.completions: 5å±æ€§ä¸ºé¡ºåºè¿è¡Œè¯¥pod5æ¬¡,
    parallelism: 2ä¸ºå¯ä»¥åŒæ—¶è¿è¡Œ2ä¸ªpod.
	
    +----------------------------------------------------------------------------+
    |   kind: Job                                                                |
    |   metadata:                                                                |
    |       name: batch-job                                                      |
    |   spec:                                                                    |
    |       completions: 5                                                       |
    |       parallelism: 2                                                       |
    |       template:                                                            |
    |           metadata:                                                        |
    |               labels:                                                      |
    |                   app: batch-job                                           |
    |           spec:                                                            |
    |               restartPolicy: OnFailure                                     |
    |               containers:                                                  |
    |               - name: main                                                 |
    +----------------------------------------------------------------------------+

	24).åˆ›å»ºä¸€ä¸ªCronJob.
    +----------------------------------------------------------------------------+
    |    kind: CronJob                                                           |
    |    metadata:                                                               |
    |        name: batch-job-every-fifteen-minutes                               |
    |    spec:                                             |è¿™é¡¹å·¥ä½œåº”è¯¥æ¯å¤©åœ¨   |
    |        schedule: "0,15,30,45 * * * *"         <------|å°æ—¶0,15,30å’Œ45åˆ†    |
    |        jobTemplate:                                  |é’Ÿè¿è¡Œ               |
    |            spec:                                                           |
    |                template:                                                   |
    |                    metadata:                                               |
    |                        labels:                                             |
    |                            app: periodic-batch-job                         |
    |                    spec:                                                   |
    |                        restartPolicy: OnFailure                            |
    |                        containers:                                         |
    |                        - name: main                                        |
    +----------------------------------------------------------------------------+

	25).åœ¨è¿è¡Œçš„å®¹å™¨ä¸­è¿œç¨‹æ‰§è¡Œå‘½ä»¤
	kubectl exec kubia-7nogl -- curl -s http://10.111.249.153
	--ä»£è¡¨ç€kubectlå‘½ä»¤é¡¹çš„ç»“æŸ,å¦‚æœéœ€è¦æ‰§è¡Œçš„å‘½ä»¤å¹¶æ²¡æœ‰ä»¥æ¨ªæ å¼€å§‹çš„å‚æ•°,åŒæ¨ªæ ä¹Ÿä¸æ˜¯å¿…é¡»çš„.
	å¦‚ä¸‹æƒ…å†µ,å¦‚æœè¿™é‡Œä¸ä½¿ç”¨æ¨ªæ å·,-sé€‰é¡¹ä¼šè¢«è§£ææˆkubectl execé€‰é¡¹,ä¼šå¯¼è‡´ç»“æœå¼‚å¸¸å’Œæ­§ä¹‰é”™è¯¯.
	(-sé€‰é¡¹ç”¨æ¥å‘Šè¯‰kubectl éœ€è¦è¿æ¥ä¸€ä¸ªä¸åŒçš„APIæœåŠ¡å™¨è€Œä¸æ˜¯é»˜è®¤çš„)

	$kubectl exec kubia-7nogl  curl -s http://10.111.249.153

	26).åœ¨æ— éœ€çŸ¥é“podçš„åå­—çš„æƒ…å†µä¸‹å°±èƒ½åˆ é™¤æ‰€æœ‰çš„pod.
	kubectl delete po --all

	27).å†æ¬¡å›é¡¾å‰ç«¯-åç«¯çš„ä¾‹å­ï¼Œå‰ç«¯podå¯ä»¥é€šè¿‡æ‰“å¼€ä»¥ä¸‹FQDNçš„è¿æ¥æ¥è®¿é—®åç«¯æ•°æ®åº“æœåŠ¡ :
	backend-database.default.svc.cluster.local
	backend-database å¯¹åº”äºæœåŠ¡åç§°ï¼Œ default è¡¨ç¤ºæœåŠ¡åœ¨å…¶ä¸­å®šä¹‰çš„åç§°ç©ºé—´,è€Œsvc.cluster.local
	æ˜¯åœ¨æ‰€æœ‰é›†ç¾¤æœ¬åœ°æœåŠ¡åç§°ä¸­ä½¿ç”¨çš„å¯é…ç½®é›†ç¾¤åŸŸåç¼€

	28).ä½¿ç”¨Minikubeæ—¶,å¯ä»¥è¿è¡Œminikube service <service-name> [-n <namespace> ]å‘½ä»¤,é€šè¿‡æµè§ˆå™¨è½»æ¾è®¿é—®NodePortæœåŠ¡
	[dream@minikube ~]$minikube service kubia-nodeport
	â—  Executing "docker container inspect minikube --format={{.State.Status}}" took an unusually long time: 3.294152304s
	ğŸ’¡  Restarting the docker service may improve performance.
	|-----------|----------------|-------------|---------------------------|
	| NAMESPACE |      NAME      | TARGET PORT |            URL            |
	|-----------|----------------|-------------|---------------------------|
	| default   | kubia-nodeport |          80 | http://192.168.49.2:30123 |
	|-----------|----------------|-------------|---------------------------|
	ğŸ‰  æ­£é€šè¿‡é»˜è®¤æµè§ˆå™¨æ‰“å¼€æœåŠ¡ default/kubia-nodeport...
	ğŸ‘‰  http://192.168.49.2:30123
	[dream@minikube ~]$curl http://192.168.49.2:30123
	You've hit kubia-xffg6


4.åˆ›å»ºä¸€ä¸ªç®€å•çš„Node.jsåº”ç”¨.
	1).åº”ç”¨åŒ…å«ä¸€ä¸ªåä¸ºapp.jsçš„æ–‡ä»¶.è¯¦è§ä¸‹é¢æ¸…å•.
    +--------------------------------------------------------------------------------+
    |   const http = require('http');                                                |
    |   const os = require('os');                                                    |
    |                                                                                |
    |   console.log("Kubia server starting...");                                     |
    |                                                                                |
    |   var handler = function(request, response) {                                  |
    |       console.log("Received request from " + request.connection.remoteAddress);|
    |       response.writeHead(200);                                                 |
    |       response.end("You've hit " + os.hostname() + "\n");                      |
    |   };                                                                           |
    |                                                                                |
    |   var www = http.createServer(handler);                                        |
    |   www.listen(8080);                                                            |
    +--------------------------------------------------------------------------------+

	2).ä¸ºé•œåƒåˆ›å»ºDockerfile.
	ä¸ºäº†æŠŠåº”ç”¨æ‰“åŒ…æˆé•œåƒï¼Œé¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªå«Dockerfileçš„æ–‡ä»¶.
	Dockerfileæ–‡ä»¶éœ€è¦å’Œapp.jsæ–‡ä»¶åœ¨åŒä¸€ç›®å½•,å¹¶åŒ…å«ä¸‹é¢ä»£ç æ¸…å•ä¸­çš„å‘½ä»¤.
    +-----------------------------------+
    |   FROM node:7                     |
    |   ADD app.js  /app.js             |
    |   ENTRYPOINT  ["node", "app.js"]  |
    +-----------------------------------+

	3).æ„å»ºå®¹å™¨é•œåƒ(è¦åœ¨å½“å‰ç›®å½•,ä¹Ÿå°±æ˜¯åŒ…å«Dockerfileå’Œapp.jsæ–‡ä»¶çš„ç›®å½•)
	docker build -t kubia .

	4).åˆ›å»ºå¹¶è¿è¡Œå®¹å™¨.
	docker run --name kubia-container -p 8080:8080 -d kubia #(-d:--æ”¾å…¥åå°)(-p 8080:8080 æœ¬æœºçš„8080ç«¯å£ä¼šè¢«æ˜ å°„åˆ°å®¹å™¨å†…çš„8080ç«¯å£)

	5).è®¿é—®åº”ç”¨:é€šè¿‡http://localhost:8080è®¿é—®åº”ç”¨(localhostå¿…é¡»æ˜ å°„ä¸ºæœ¬æœº<127.0.0.1>)

	6).ä½¿ç”¨é™„åŠ æ ‡ç­¾æ ‡æ³¨é•œåƒ
	docker tag kubia luksa/kubia

	7).å‘Docker Hubæ¨é€é•œåƒ(åœ¨å‘Docker Hubæ¨é€é•œåƒä¹‹å‰,ç°éœ€è¦ä½¿ç”¨docker loginå‘½ä»¤å’Œè‡ªå·±çš„ç”¨æˆ·IDç™»å½•<å¦‚æœå‡ºç°:"denied: requested access to the resource is denied"çš„é”™è¯¯,ç™»å½•ä¸€ä¸‹å°±å¥½äº†.>)
	docker push luksa/kubia
